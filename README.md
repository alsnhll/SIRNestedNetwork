# SIRNestedNetwork

This Python code generates the simulations presented in Figure 3 of the manuscript [Crowding dictates the epidemic intensity of COVID-19 transmission across China](https://www.nature.com/articles/s41591-020-1104-0) by Rader et al., Nature Medicine, 2020. 

This analysis was conducted in collaboration with [Ben Adlam](https://research.google/people/BenAdlam/) and [Anjalika Nande](https://ped.fas.harvard.edu/people/anjalika-nande). 

**Method summary**: We simulated a simple stochastic SIR model of infection spread on weighted networks created to represent hierarchically-structured populations. Individuals were first assigned to households using the distribution of household sizes in China (data from UN Population Division, mean 3.4 individuals). Households were then assigned to â€œneighborhoodsâ€ of ~100 individuals, and all neighborhood members were connected with a lower weight. A randomly-chosen 10% of individuals were given â€œexternalâ€ connections to individuals outside the neighborhood. The total population size was N=1000. Simulations were run for 300 days and averages were taken over 20 iterations. The SIR model used a per-contact transmission rate of ğ›½=0.15 and recovery rate ğ›¾=0.1. For the simulations without interventions, the weights were wHH = 1, wNH = 0.01, and wEX = 0.001  for the â€œcrowdedâ€ prefecture and wEX = 0.0001 for the â€œsparseâ€ prefecture. For the simulations with interventions, the  household and neighborhood weights were the same but we used wEX = 0.01 for the â€œcrowdedâ€ prefecture and wEX = 0.001 for the â€œsparseâ€ prefecture. The intervention reduced the weight of all connections outside the household by 75%. 
